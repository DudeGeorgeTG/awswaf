import os
import base64
from cryptography.hazmat.primitives.ciphers.aead import AESGCM

key = bytes.fromhex("93d9f6846b629edb2bdc4466af627d998496cb0c08f9cf043de68d6b25aa9693")
aesgcm = AESGCM(key)

def encrypt(plaintext: bytes) -> str:
    iv = os.urandom(12)

    cipher_bytes = aesgcm.encrypt(iv, plaintext, None)
    tag = cipher_bytes[-16:]
    ciphertext = cipher_bytes[:-16]

    iv_b64 = base64.b64encode(iv).decode('utf-8')

    return f"{iv_b64}::{tag.hex()}::{ciphertext.hex()}"

def decrypt(encrypted: str) -> bytes:
    iv_b64, tag_hex, ct_hex = encrypted.split("::")
    iv = base64.b64decode(iv_b64)

    tag = bytes.fromhex(tag_hex)
    ciphertext = bytes.fromhex(ct_hex)

    return aesgcm.decrypt(iv, ciphertext + tag, None)

if __name__ == "__main__":
    print(decrypt("6WVCn6ZoprT6xfJA::d2685f2c0c84d280492bf9265d4a3740::53d7bc45e2cf2791a5b0c331051355292bcc478edeab61de1ef73b5de05ef0fba2ea3172a6fb3e09fb49a692a4d9b0d7e145bad44708a262b2d0751e3ed3d495714cd5521689122e61f989be90d88efa981db978d180ca3730d4bb7f1a2611aa5e67c881e415a8892679a99e6b2bbe8375abd8442fb23b94d574d26acadcccd962f21df8bd35315a779abbcfe16f63e0452e0f87ec43652c17a0772b20d7ef5a0304e641f0b2eb8add370b8ef9fd9f3e7450ff1789f0427cac17a65b3ec1451c19d6b4cb7276f91ed1538eddf5a153c6649dc1df0653d57a629ad485e5ec530d9b075b33639451ebc3f02882b646dd7a86615aa578d7f3df62c13d29ae50001dc38da7d043412a9fb9cbfe6787188de02bedb6981dba4286b1384d95b3118a8fd24fd68a9ddd155af78d04d89d35059b337f0628506ef0365384f87fa8221b8462adbef77f75b82a19eddda91fb3f0b0ed51605dcbd5c8a79224234222777953eeb94ad9688e05a4cbc0ebcdc823261b902b6be664ccc018f1f56220a5b4ca86cdbfe61cb6937823a789253a4a670a32c5d6c188a9e819308fea8f94300056d52da99cd05ae14bdf4a7c84a91f33b38320d2c3e08b84566816fab43240683c57343bc449ba8250a405a595ee3ffe03b3b3b431fd2c92bdb8d3a47222371b44217e5ad858a42c5679f7db9ca9b8330c3bb9e3ce68127a1c4e288b45f4f35ec8fc19f04209f0639fbf54802703bf8ea288c505d3b8b4bfbc07a517d4b8c5a6448f07d9a10968d54910b002154addbbb2ae3456ad3429d9d898c42fbeac2dd755e47a14aa61db895af3fc0a08d43b89475a679792a11165e58a038bd129ec37419ea1db3bc648bdc073d09c9a8f66faa2e17de8b3d6cf98e4997c7411e3278ff1762705924373a74a78e6b8d0e556c10718d5ba3e51a82f38b3824943f31f43eff9110659d48bf94c99ed27459f8fc9bde07626241d9c4d742c1e0ba9edceab3c9067a581a4ca7534555fb4922c623e3ef5dc6b6ed5224e28938beca7f7a2f74160868ce90afaa8dcd0905729484f80e8cc3f2bfe2069eff6e9bb911d9b25f107f4d0cf8eb39db7cd58047739e2e1e5316d68e5b14b78e2e7496e223b12147081d9758414868e1f53e793cb5996b3c15e1c0fd4a634b83e3a5721693ae0ef6ab03701ab8bfeb00fb707f9996092bd63ae91115ecfacb9ebc830c54d8a59e97adfb594a1c046d45faebe5b1f9e6fa9efe510d0913c2096f10349b0c8b4b002f3583d3091109a0f7308965fe0604df728de6a23fe3daf5c15bedc5cf56e1a5be725fdecaa62d3b461b799f4976ddf1187eaf45aba2ec0c7057612c3aa7d2e357e14a0cf5498280c2315c5dd3aeec0bb65b8c888822aafe26ac5f0d90994821849a77f38d8f8e68d63378383071e39bbea5f93199ba30b69fe2f4d9fbff88bd88bd40af7c6d71cdb38379feaab5c9bc82f2419a90009f117179327a914629e7107475487d078cf65b547dabb0d94dfcca9d4d27507d02c09da1991f660751e1620a49daaaa40b6300be3911b148733457f864e0c6c70310cc67231ce3631181ca48bc8e130c64bca16b9b6858c45af834ee6982566f74d3748e46002dd717adc9834cc1dcad8bd708cb9b71406d6c8e281d7af1628e428a00a18507e77191bbcfb20ccb27071a34c26fdf4bbe53d9dc67751aeccbca88f44a8904071f2c7ff53905aa82be1ebaa8f233553a45390858e37558be548a45f8d05856b547ef4a444aff1512659e5fea9abe122847b04a721df64723e6bb0741e63ed0b15e4d2fdeaec3487bcaea90bfe6f1fea0f52a0486429620d1f2ca055abaf32a8fa38a1938d8d86fbf37e366391fb7591142eec83373ccfddb1fa21bb856a8f72c37fd79b9217c0c300208a0b6e98940bd658b2c710c2550d918f7135696ab11152e3ffe86a1fa4e163e22a0be13bde12732814060c1b9fbf4592c5b813135675a6a4a8bac07bb3892e9b725465d9de4b234436ec94bac5a001830cb8953f42fff8b4ae857b9253c143a3a9569ed16d13e4588921ccdd977f3d2121f96b33b24caf18434946eb0fb9c137776efc51cf394679f99a9f3ea76e66272033f4285515c07b2814ff54d93277065967c73f209daad2083076fbfad11d936ec2579a81ffa728f9c5699a2425bf2a74d0ed16a20dfa2d2462f7b31e4579f9d953e35b178522af2f87ae44613d093a22fbda58b3b1d5dd398c157b35227bdc09a3b1f6e371292696cbdb8a7dde8e448f1952705b3120701a34f072b67ae1579b015b874e3dc6712793818fd17332caed1f796c2282d54b2bb72ccdc79f585eb06c16083c2250f248b55a553879efc3bd2c7fa0ac5f6c50cc3165f2f0d9eda309d2eccbb5faab629ff625e895948655a2c6f652e60e4b427dbd5e3b0c17183e176c7f393a16484ac93848fd83200c9719d9d2571021226c09c6b758cb505c7dfd101a3b61b4f044378c588e6552c1c864b5ea0f567fc4dbb9bcfded0010a9f272cfc4fa6c6530b245fb286c1ccc288241ee5a210affe0c6a7d68ab09c8447461bb8cb41dcf34b2c0458e873449026e4798abc2c1f1b81e713f83539f2c8b5b5c52b864314e437ed64804abaaa24f2a256abd28705153ce9ac945d2952e00a7d5419441e37f4766b02248e47625fdf3560b65156dece19cee5307952f9529c7b32b4dfc50193f1ee668537f117e7450b2b857d34ba305251fec7c63bea0a9782ec3959e7b6dc50372dbaadf03c5d86403165b64fedbc4b4483b2b58938c13e979cfd5e750ead4108883e8ba148613360968c5225304b32379c860f651ddc5bd17897a2df9f9864ef3ad354a022f36b3bae70588b67a75c409e6991250f74b4826d50b6498a897531637d9d62e6eac170caf7b6951712088d6ff22c7ddcbd30ccd0fa8498894f2a9fed5fa558772fa17659231f58f065941f200831d2b85ca3c1c2cab43bb37ddb31e66e26fb81e1fdc2bf13a22622499ae89be3683d879855da61232d762a147fce3f02aad4e2d573e1e768f67d1ca648625195cdaef4f5578aa43ad27d22cca9ba4924f16559655d459ddca50149533ed5d30ca37e08ba2c09a0c5eb6fcc8305acafd395d38c8e8cd971e66e35285ff6b31e2ca94d2affdb8bf4ce7cc4b47638c8ace644bef107fcb60fa5663475e399fa9e76012fc0f9180c1502b19ce787fd4d8c442d478fe6fe5e4255e296376f972310838ae3874c9514f1afd023c7d0269281fb7012e163290121be0507893f6fe04a901cc16f7565a6dac55a11b1963b163f54191686a8f488ab460ff07303bb297e79fcdb646ba55f22780b6a7879c145f614a3e6a38a7fc2aac9518b0a52bb07116001f8bf982b73e38fe4a010cb946f4168222c552665e1b2dbb1b80ac52d7e39ea44428821aa4aedcff04e6cea96948f2463493dc5eef91d148f4fce9013c01c00146841e5086a6ab7477deea23a431f2d7d6463644b9a79b6bf536bf2168c6aae09b985ac990b57b00e640867dfe8304e6ee2ebc57bc5eb6f7b492c364d0f4adafb886db9b70e87ef281e5898e91b8835983853ddd11dba0a1096e37dba2744d7e8e82a86017b38d0426fd5a9485a4928997ddfad54fbda4700cc627b1cfc97132cc91bed43906b1126591aa1f1786ebd6cf2be469abd990c9d4fd8cb81d848b88e64985dc1459d9536fd010060530826237e6e8635817c4d45c5c21387146f5f1afe147bb6a65760dc0c6d492d1e940497a4ce5149c48b7ecc01c1d405f1d8dd1baabeda889ebcca941233addbe3a91419b13da02c73080e4cf11c96f097ac74d2825afcff773914242727ed2998a63f901736e093f54e1836c1b6ca9ac9a707ad87d6521fa0555ca139a213b2cee3d75e5d5b0f7c6a5a5885e51f564354594f40808bae5f110c92f366aa5b19b89b2882f93937b83133c11e923165e500a3e1839c3ea37ffe13105b6c656279715487f7e63a0713ebf0f49788b1724d6f1198444e0513ab89637ac609c121a8896944ba9e719c0b53a4d640082e291757088da0a52d0003614323f366c375786f16b36eb4d037cfd9720b8c83a93cc5eee24ce22f07b58a287ce93b4d7ce282abfe85d50be81643b05f665fa8c4edae63b1c7476841cc03b7498ee1bd44e28047d137d775229cf6013e85eca628fd9ebc8511c6c49333a96abdb7d20030ee0d21ccf4032ce8c3e27f99d7af1a27f4628c6c7805b2c646b08624feaa5eefbc1fa35a80a88492c39bff4333efad4f467c37791b271e038c8ef7f751863e6b434677e22f3a7353f10ff46ccd8f3509169e9366fe490fc627b09a1284c3ff87bf6dca403d30d7629446e36bdeac36d955d0484a9f059b7e2ee2f659ffdfcc02f5788e318ab9efd50b0359c610d39c806554008d05d98dd72cafb450cf3127809595389a8b250d6e5ab9ece7d75a81a9c1a37aacdd08e8cee679b3b7ea6ed9536ce46b6a0b575a3f2eeda897942fd5b0ffe03e6847e2ba9ff857fda981aa5b042bff85d9d71a6b0b32b911a36fde9fb1a51d0089349a8f1baf6d85dfdb83615413874490a6f1615f6d0b5e59174cf1609922ee0cb1f51f5a09bb0848c27faeff3009e1e8b9e0ce51a0200a01b44818a0ac78f636c438ae4baecd9aad0cf716392f11cfccb3bfe9f8e68dc43c00814d068c74b570a7a0f0d928157c2fc7727418c7cca205d164219411239e4fe2ebd99e1f745879a639a1dfe5197821073a6ef9e5cad8fa8a10e35b5da21e624a03b29cb1ca5b24d2fcf1ec4bab862cf49ffc36282484cfa70b7bc3581093911e38cacecb03d64c441a23bc16ee0d264f88d57a2391a3369842da388a1b111d8e878177ec45bf491caa95e404c05918b1a22aca1dc2c8b0598e4c6c2b011424830d0b4a968b24ba6ae9e358558908dc56c219fdb8e2de6b4664d806b08776d2e44d8ebb10ede114054bfedcebd3905b81b69381f9c0acb6ebcb0792294ff8e40b7c57fa00e1f2da1dab6b949fd83a419f1731d4aa7ead5ebc16bb37e68ef48e7bb308bc07b48b3d1610d50a06759a1b5e07ca383dd5aecba960dd401533c4422a3ec1825d9417b2d26f564ffb84f1f84e59ae9c7d4f156baca1a491b3dadfad22fe3919dc0af06ffeee469b9dd1798487c8a0b502745fb265bd0e32d5a256cdc02eb24e95c9d60e08cf737908b265f8"))