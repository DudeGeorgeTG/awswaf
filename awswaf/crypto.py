import os
import base64
from cryptography.hazmat.primitives.ciphers.aead import AESGCM

key = bytes.fromhex("93d9f6846b629edb2bdc4466af627d998496cb0c08f9cf043de68d6b25aa9693")
aesgcm = AESGCM(key)

def encrypt(plaintext: bytes) -> str:
    iv = os.urandom(12)

    cipher_bytes = aesgcm.encrypt(iv, plaintext, None)
    tag = cipher_bytes[-16:]
    ciphertext = cipher_bytes[:-16]

    iv_b64 = base64.b64encode(iv).decode('utf-8')

    return f"{iv_b64}::{tag.hex()}::{ciphertext.hex()}"

def decrypt(encrypted: str) -> bytes:
    iv_b64, tag_hex, ct_hex = encrypted.split("::")
    iv = base64.b64decode(iv_b64)

    tag = bytes.fromhex(tag_hex)
    ciphertext = bytes.fromhex(ct_hex)

    return aesgcm.decrypt(iv, ciphertext + tag, None)

if __name__ == "__main__":
    print(decrypt("l68hvXqLYaaSxR2/::201bd2327c328fd6f2fd459b034acacf::05a8498df1ca96b3b71713f4aabdabe945c00822aa3d4ca53c68ec3101ff41d6fee0479258e75e359d587fe664d02f5d72c15e42a1e3544912beb161c67cdf29ee632901b6f3110526b057fd001d909ba182c801973f26f26853294de92cfc7fe50df5ac5f0942b8cee6e5455e3160318a472b480ab3c5b54d8fbc61901de9e4dfcc4f2d08774d5f72a5a493640cb2e577bd6cf223fe6241025bee7e7a24488b71bc64acd41ff9a3c0234b71b4c26087a427f11fb0c3662e2991b422825d46c858cb286642a9e65f4c98dc33edfeb5317eca300a5930bb5565874ec232cc90a036554b8262fa3b05448ef3a2178359cbaa7735de9f61542836801c7367b1ad28c2b6c4dc45c30725afb8beb6c801cbed462319fe8cce93359419b4f564f8040d28fca163802b6a7d2da2e9a0dac2a965974bb6460053f9a59a31eac9ac48302b1934153f6a8678178bd78813ccd0006eb52bedb7280488ebd4b49422f86bc733b440a57ac710d5f30978e8f93573804aab53e5206f684b6bb404f37416ad62e667bdc9987fd6c2970f7770f5ac3c7928492790e2de58fbb1b7d41bbbbf6fb14ed3f0e9cd68c1178fd41cadf1c14f24cf274d4fc458f7c894a78a223ee6725236c474abaad466c70ec6fda4402796566d29ef07a79be27d97b1927c930cdc209f2b2135e16b429d02b1039444475bec87d442c457f75831b54ea04ea3423ca9f754b00f2728e4045287fccabe50cfc185f545e0a462787eaf7625e3fd7a3e38c7580cb5ba1bedfc29d3ff541f9d1382893f9cbfa4bfba11a447d315e428a7c7456415e23668cd1da5a14827cfdd1d9177c6d8d23767c798d7f3acb5c198f95bf0e630e78a980731ac579c2ba437355b78721b8461e30f04889ae6e4e14c5fde09a53bd0d7d808d63d4bbba0397744c0e6c3211dee7b1bd2902f497db2233c39e4107efc4d675f5b9e0e8aae928e2ebee40f48b4c553ae0b69ce95b85b620f9ca00fa976d7d52ff315161d394953a390df78b2cb53220fe35b1abbde0eef43143099cd34da9743822c2f05d547b0095c3094ec6a1420501b7a0554552770f495991ea560d610974b0d15931659417478676a203aa61cf4959330061e9b9633abf839367cd202a2c90aea17df57f80eac9c4b7bfae19bfc3c611c180ea9f33801ced8f8aa0e59fa5ee2fbc9fafab106c1b0acbf0072f98e5453ddb9ed63b552e71498fbabfa3d8ad032cd6a84df63e468bfe350eeb1fe4cfeddb7ffdeba66a9e8d04c80b5bf2199f41a68e52c432b6b0d71ca89d48257e8c1e27f57847c534a487c55ccbec1fd1632afda938260a1d969112b57c758fb8121ba80aa2902f67018ffb2540c2762bea22f963e6b1b614044fc8fe52df1c0e7cce93a7285e8370e1355bc6190a06b6389907ac9386c70fbcc531b85809364bb6a25f2eb924e5ae854124f6756e6cc427dc787577c6f5a8fca48ae735e259377cb59f425a5ebeb4a31e3740b18e433b5ac2098b345f8d28a42ac219d47e317950667538b2ab36b0c69ac2f8de3d6c31a64cd87a8b111bc2914fc9b2cfb8edaa61f081ce26cfb562f97de890b67ba031607b63a028b3c976344a8fd1955e93f75b618a4604cd21ed2e43af43e566bcddd13b3d5c96552821b52007e6a71a5c8af9a8ff3dc5ba3eeb1bd2005b575bd76ff3998f82f5226041e0524cfc620ebb19b2df7f34f1294e40bcbe49d7a5203e2d5c6996aa8a49086d99536ac98cd8c6dd90367fe34aa264b933218ddba3838907a95f9496b841c0c1cf7d93d58d75b74288d2809b88d2903ad636e9292d5ef05fb1697aa9d071dda6ba4de77dcd6d96d2919a80f92b3e2387d13aa8a37e6aee4f85dbebb405ffc057062cbd90a97aa2094bf8130342fa2f2436dff7d69f146eb832e05d7404a28d2b6a1b10183fde5f06e1c7f6740b14df153610f378e3e1d49fbcbd8e5e02a0282c4a1896cfb2ae936ba0b75e9fd1ab5f15881848a172a1dac673ce357d5265986fb4c34feba019708dbabc2f076bb526386f2fdaf42acf91586c0f24df2d5c91d2f6fa8a569ac40f225701fa9d5619e82be235aedebc50aa9639b192444cf0f2b5bf4ad13097a9768d70b513c948b782f71fabe2675702c79a7e0877925ddfd87ee8a7e58950522b0920844107f2461971b7e4826b21502966591ecf26e6c41897c30d3f5b08f9b5ae53c72a65fd6097bb9b9a8e065ea4a6ae9b7fae260ff59df6b66ec7299de9b0bcc8da013e8008cc0ea249326d12ae2db74df5cb504906fa9725cfb470e7494b00d697967df8522f7b91f597d5f95c08ed04e7fd82f75d692536eb7e4213c30a82441bbeb08433895a825a2ef9c2b0a825b927116b92b30d8f9fab6925ce9274379687cb9bc9db28ae1e169bb38e8063ff72ad8f0e39a7117d7176d5425c3d7b80a50b40f7e1c3b44a2531dd741171586745d3fb5da7c1cdd0c2b0a0ab2884de5c31908c287d2acba46ed949808f40277b19cb31d68f91a63ad78253c576156eef10540113e28206e299614a44dbb4955e2cbd9e0a15278b11b9fbd2bcffff2fa7914426166d37df8dd68fbc1f5da2ee9e892675f9a50faf655cd085e6138ad484e99ffa82e7e65643a00d678cfb77d8521122ffcc84be150a804202d364d96d757600286a4558144390e7cbdab68ee65f258decabb2c33db41cb497839ac6821220193f6e561d382feba1c5a883d27b974c8c3a970e3c7adca9efd98b2f46aa68ad443e3b641038a71cc0c77dec5cecdbf26bfc3ca9c0c5b96c7774aadab6f958f189d160ff2b4883dbf9d26df48e8d585e6abe5e244a22785c4779a7ca1210df238248f4e877faa7e2f864b8a3bc510a214895ae51c0c2e611a1f937d52ce6213a74495c5e77e49417d2169f7641dc16987627d5e3c405530b57d0d1b014fed08c62c22af4b1b038bff7c8a3b233db1ca2a66148027d943da0ab09eba0451b83e92095eb53a814191260a071228a1d953e50ee308f98d5564069042859bea3bcda92f2c2c265f24174d48694a75f66b7a619db65e26c93503d067a50ab6af5468eaf4f937823d3e365d3011ff882f584232ee0e53364b2c5bcd31d8c88a691470c5f79e78e41b9387dc4989b8bb76c28cb1417c4ea2ab08ae2e41877a2e8b9dce18a80d7310603bda6a26fc8989172a462c7abe28f23f178fe262355455c7c077e827962de05070352b30768c41e8a55baa85988ebd015f10e23b45f8a24fc22a706524bb12f051537e7782e608129d444c970f0f23cafe9ef0f2428433435c871f226336f1586839c7bdafe93febf5c655cd1580245e11c304572212641f19d2b02c737d27c6de945a3ece8d553231b21acf9ceee51768092b74312b4582cb2c1b54dc2bf2ce21d0f5954a64e05153e522c75e2b22e43dce3601c43de0ca2a0893d5b92cf7bf3479f5398d19693df61450ebb9b483b94c8394f2c932e2dfbffa6a799ba2d42538170840aff4dc1a095313e45b1d04dc6ca2bb7f10300c20fd7d6dc89b828076b037cd165db1092b5390faf8820670925213441a3a9f2a4c81d9b5d1cd7ce5c34a552bec8f05cfc790303625801a86142ad15d86d05be7a66c5aa2a547b7d92d2f5df98c14e9b337ba205efb9bb7b063d8a12711601497ce9c943c3f5e6039b5ec7e47597ceb4953bca9a597b0e9524457e0faabd6b5ecf5ebce793b99092d40f3f37377e734baa056eb13b7d573f641276ff57ffe80ba939d01b99695449aab97364f45f05f3be5d4f35993369548383696211ddc47d3a5f504fb685550a10ced2c87c31e81beac3d10d2007cd342fa065000382d2ed1ee5911c0e98febe9a9acddb45b79cafa875603f49c3ac5a7afedb4ac3be948139185f314513e9aedbb89ce7e5d7eccc587d40f9ba52e907c6407ce0b5764013cbd243a1af53b79b1d9a7858bd080fda271852b4610e3d494c3be85792056bb1beae28b9a9f9bd8ad7a5341c97a3c3d65f1ac1e2f77112c2567f905ee3c00464b4387d3fc1a2f532cb42ee5f38f58f24466a9e2c3351d25d655e977c5af8c7674f7db833f5d6b71e97ee687187f13b0478c9ba3797ddea375aa8668394e651fee2cb20f47ea28584a2bc708d9cce57c65b055f06716bafa854cfd86ca0d86475f1fda6eaf51ad722744dbcaeb84fc521d5c2dc92f08b3b4ab422460ae18151ac6dedd6bb07ba27dfd7b9c5149e4fd40e32c473f9168f07c7d462fda739182907055f918ce1c0d6f847bccd3df4e8095ac5983a4cf7abd1a9c9205b6d237d4f3dc3d4662f8d191a99417d0d302c4ca3539518c7f1c497e3c43903632061a6f214ef0c7c599ca6ee609b240a0903f17527bb4adfa88317975ebeb5554931e128d4c81c63d374f73c2fb2fafdeb6847334ef0772277b2ad0bd97c5ad18ec3743f73b4a4e3dfb9c0b01b7877e4197f9c169d2fba3613c93b94ec01b0330e31e58af052085f8d433f55889727f76eb53ba3830c0d49beaa4d986808daa7764609faaae521e5ccc48ce484f6f33159a819c587adfdd2ac1ff4ecf644af90fbc3c67dbba076aa217c547e6ba372ddc0358b32e44f76758f5a04f766e0c02148d11f10d8fad213a61f576773994edcf0e3e731fae6ea32f8f6d00c5d511eda623d7399cbfb048591506822122ae4fa2c664a4c09315f1a793b0ea2d3526fa0a91c9e4dd8f62c73251a33981378e8887d431bd336c5a546584c9aac59628e4e6c128b2c5ed5b0400ca50aff2446cd1166604d5fbcd4a54fa81c8f39b09530e3c224a8713d17d83a9fb1744ce7ab06ad06e7ac90ae06647169c7e4a71c0823a3641e709e3ef0d760c115989f8cb29942a24133328b3cc559e0149e823bd80754f4b3162f6c0b252a0551fefa06df7d84f79c4b9dfdc6f88c84c24667638af4fa955786299da58eb634d4844478127b8532720f5d8d383b57be1f01a3d264e6abd6aeb15011fd8e55ebab1984cadbc52b8997e9348035a0a13dee8b590b86ab07d50cacdc599fb2576891284f06808fbdbf4aec574e1c9476dfb25b42c6387d488e94916d336db8e4e687f2e0e26ae7e35167895ac0288f1fcd22bfa35dac52651145233d0fd2b1a69ff3155dc3acc738a52bd06f2ff1a7cd5d7ec6199c9e677198391b338329d24471417ca2e32d9e0edb7fdd1e19a9318bee4e5d7f66cbfffd0453990968e6de9dd94f0aae15423b65275f66cc4fc58"))