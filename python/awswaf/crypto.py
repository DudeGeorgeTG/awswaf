import os
import base64
from cryptography.hazmat.primitives.ciphers.aead import AESGCM

key = bytes.fromhex("93d9f6846b629edb2bdc4466af627d998496cb0c08f9cf043de68d6b25aa9693")
aesgcm = AESGCM(key)

def encrypt(plaintext: bytes) -> str:
    iv = os.urandom(12)

    cipher_bytes = aesgcm.encrypt(iv, plaintext, None)
    tag = cipher_bytes[-16:]
    ciphertext = cipher_bytes[:-16]

    iv_b64 = base64.b64encode(iv).decode('utf-8')

    return f"{iv_b64}::{tag.hex()}::{ciphertext.hex()}"

def decrypt(encrypted: str) -> bytes:
    iv_b64, tag_hex, ct_hex = encrypted.split("::")
    iv = base64.b64decode(iv_b64)

    tag = bytes.fromhex(tag_hex)
    ciphertext = bytes.fromhex(ct_hex)

    return aesgcm.decrypt(iv, ciphertext + tag, None)

if __name__ == "__main__":
    print(decrypt("40rolXKpxLAl1KKW::5a84ead18fe26398e04ae65de68ea050::4d053332d2e76b24995e0dec4f1f4f24b060177557421f9efb2c04d213a54f6571a9856bea6e1a9453dd9489b7cd5f33d19722c0ff49680afa7583836e8ee4729c36e735cf03c789e7d4869a93fd5937833c3d6505cc48bb7a9856bbf9f134016efcd4ce08f712f5e1afbb2c9e363cc1d79ded81e1676c000ccc523cdf680a77b2fc4a83fcf016acafbf42710f14d65dcab7c91006f8d5a9fdf912c2667eb182c2ef2abdd424e72761c971bc1a066d91d0b6d6465356d0747519ddbd304144a493132ccfd5221dc6a28fa1b4a410a81b2c09857aa635a8b5f9d306a1b806ff04bef48709873a89f0b5dabe9cd6b46fe9c10c3bd37fc2b0996a286315bd7c0334e4f8e1ce25d470eddb903de707804def39636bdc851cc2d94b91975c59c1b43a6241739840aae6ce0993e82114a70b5bb575c50cace4bb5e8e0063fc47b66cb5e7e5d6eb736c7a66a712bc82db904aa4080225e58ed90614bb3b65a0e8287f0689f96bdb82897d0814c2efb0318852d69f4cc163d4c2ac2fb231ff4542b04a106aafc031208bd400ab21234378c05a5e3d3d51193878071d8bfc50d55bacfca464964545e77f6d9c54dfbe066ab537a65c4b3c905bdd7f24c40a721e31958ee2d25053b854119f6826bfe72a0a79fe62026a5d2c16341916efb0a74d3c9e883d34ed83a1a0d1c8656eb76ed1edd3383d49599a5e508475de5d179970b90b4756e0602806b0c8f8c013aa27f25eafb4b8b9f61c719157dc4ad1fdbf6918ecf9fb7ae285604c43d425f5fcdac7eafc1bfe9e911aba22a9c93bb04194a79beb65e72339c9be12f3814cb7e78918bd6a0a7021b3e25a05424b446f7fd84f5d30a05b881f726bf045cb41bd90fbe527542fe2562c8dd33ae98d5b11a47c9cd7cadf9dd3ab3e3fdee9df67966ca29722941d3d99afdf592a6ed3a6a3f69b3e00d0d3b22519681a75ec902e3c988cc2e6e8848b7a819dae163b41afea792cbff30bf3fc9c6e42f8c9feeb20929441f941ed9511a11c4070207c0db919cb2ad146814977a47f6a18f913f35ca06a39083d87110de01badcb991fab1e640ce850dd1822057a5b4d2b2b5d3f8888a0cc256a76964192bdb5f56736de16ad30d0cb465458cdae6e8543cb108a387ec9fbc5ba320074e0db40f3d9684af6e828f05f8ba540e5901577c81f3eb6b1045c21497ccd63c1213285252b546798b12143477ddd29bef521f62f54c3bf5258d992766ac472473553a0fb864446cc5fa2b839a9a80164a5504db8faa12d30b031cfdc7bd659b0df72f25c03e609230d291684f5dff41c7984423cdc689f6680cc886e0d89e6e2f7cd230c48474df980f205073d822291a0ab944581b368e556a4acd79e728cebfda21a69eb2802ab4a80a5700d1e78029c6a9c3bb15a06b8c7359bfe8f4b86dec8e943a63ec4fc9327e430ad937ba271eccac81ecbf414c2a08c867ea5f7e6836702a1d2ab608f9bfcf62b3469af07133a05df5d24e6da718e724ab23d25382a8c000063b86fe7b3d68a8c68cff40b371bd55924c9977e390e9ce4106bec7cebba02e043aa2aab37d3d03ef4cb3800bb5715538749e4ed4a6fa802845cd721a1e54f8ea4cd0a902a5e932ee02d3821557406eef971e9fff365bfdbffc9f4289a2148ff91178ba0568775d29b76c8b3fa48e97034d8f0b8fd31407d9146c766572a952f012c3bc34392a8aed3b4aa1c8e15d66c7216f40793364be84a5a76c4f3f0160554e20288e19dbeb7ab1a36506a8b8a12044e88adb36e50200d054a414c30775439b94fdbd7198f591db80bacb71901b502443461643696e18c32a0d7d62ea2491ffb17bb693a2f8ac0ad6415d7e7580a94acb2fba09e1ece0bf4722171046d6586c1a778b3135ec5d0bae900f3cb767585763acf13c59fd0599bd5171d2e38d1a49a60f097ff2de899dc5e3a1a383870909506132cc6041a70fdb5a94a6150e906eaf85fd7b97c797acdb73ff1839763e2a78efe15e0655e78540899f51e7d5e915d89fa9e5d0db0f6f6bbe0d8d1bed55d32baeca6352b020e2a6bcffdd05b8a47fafd720bed7514c11819d5e53e4451c3a3ea69f13ff2f1de1c732aaa93860008d2dab8f4d3e386760ed7f493e03340e21ab1833e5b273e90cf5293f8a6e8392c6b7b2ccda490624be3e6bc68cd6c5ba68316d9ca99d120d75bf0f392e7ef12361ad74f805f2164e26c295a50e9ed0a56648990a4ae7a2f0097a008ebefb6688883aa0dc8bb29fa60a20a33676b0503473bee426ba625192a178f3762861bf900348212bcfbddef1ff2d0dd956b323f1e83c1cb00c7eba52c6db0aecf17d6f81a53df3ed92ab8cc43f37e947dcda66d3b1e1727831ddfc0031277a82cb7c338900a07c85fda9ea20b255496edccb52ef6a0c9bf9caac6c6aa3386527f485a6454142dd92a8444331405f753707ce0338036256d378edf687828b6217b80fa9197b6cbb1997dd4eff65a52fe7241af3fdf41a3f7edf94c8bea222e271af93a5df904d44d84564fed803aebfca3a665a6a4f8dde7cd3b599cb35ca0056406c1f22718d38ea8aad797afea26fff6fb61e5666c33052365e88c7cf864ed5eadb288ff9a171d30187f41626947dcc5b787b8e97504ee6c7da4197086919ba66854a70bc0c5e3e8b47f01c4ddb843bcbacf697056ddd4abb240f01f0aa43cacf1bc64cc4886f8e40416d21c9d43278783e763ff24d70ba7bee116b89271255d16664b68af5f8f799273cbee474d82da8d1da833c2d77ba6231349985953453d40c7eafd87bae69dda1acce710178997a54eea5eb8f4b12c9ec7c03b395b4a91ecdcfa3c72dd49a3b958da7c1805ef06d1888a53d1af9bd39c9dca7100c688e5e037fdf32b02b1bc0390c7f477dcfb56858e26129f3d221feb22056984cc2ef4bb3c2fc29f0f33a834e0972412a0400db3bfbf9ad9b075e32ed00afbecc2c4c5103d1e94208beb7725f5ac186c8dd495e0b303df2e5feacf749266acec9b8ad8934499d4a035a150ff1c5d73565ba31fb3fe45ee430518ee40ab2be66cbe0fb901666a136f481c7ba16636a1e219df8ba4ac81df8d67aaad4ad607d50870efdcc403a518f4545f77977a3e110c67febfd6caa78175830b116873bd4bcf84919eb9c08f3aea376d161b7da6e56df42a72e34fe42880eb4b09ee2d37ede5ee06d316c79ad3d2a428c9ce04d22e0f02f4e1dcb8b0ab8227e8eb5f65f286728c5a199a8f6ed6d80cac243093bb801edd1d218f7f7d8bb22a2aa8b459d642b3c4670b4fe6401a60dd9dd317f61a5b33999a76aaf07b5e686a5b1d44773acb3f9dd51c4f6e6ef7cfb832aa088f0f94eaa98a452d53ed9673e4020e622de48ce78e26ae6eeb21def67e1d4cee1e0c1749dc4aafa96f89d104b289051da8e9fa1b919d48fa45e5c007cf2564733d4cb36c552c368d1734170495593acf7c1dcc1cdb3b2dd10fb64ecbe4cab1ec34c1d9058fc6ee94939519c5df2f4845d04d63b6189e381880281424e1c0163c22b4aee86244d0281eedf6c36b42e75e317330558c49deecbaf5543cadfdea2e04839ad11cc0366ceeff01f1a7e1b2ad5d1852d1be8ce9d5186c1a21803b9818f77f72934dfde0fe5e865361c333d7a031ff1b5a532ebcb322991149c13254c48020b41b30b5ad2cf65ec128b17fbf8339e95f7d7db4391ecd5c7cc35e75d7014602220c23f9d3a97df6927fe840bd29ec6940dbac57be99837d532aba2c121e38903b62c7f6e4cef7d2278a95f3916a203b3135059cb70ae3590de33720f7037f8089e9a4af72c34f2cf111dea0cd76d0be160fe16ce3f4bc22e8043ffa4b345d3fc575e2cb077dac556e45fa9a06f52be6d4da1d6fb6a9334e8bec2d463b28306fc114959ebe5845b9773cf736d98719bb7fb0f002f2f3b3150b177ff7ecfb3eeb73a7ecb968c97ac8a551d3993e07b32c51ef9c0a1b3bd6e2cf1c2b40f435d130990bcfa4c9c2e6d0671288b3d6156b2123189c60754cf55d8aefd6bdfe2bb646a445e018a31fadd9e3c62796c4383a5ba8193733495f9d30a2814ae40cedefe13cefae7091fe9ce3c6df60150dc4bc58b5bafda850977c085479116912c80a338a18607ecda29267b8288407e88ead0b2ee73ea1b36db4d68b953b1ad83595580443df1d51f65826b8464c55e80fbaa4f491d1ea340feae36224b6bf605a84f24b0efef0c76b1dd23838a2fb6645e32e34cab67dcf3ca0b8e14e2eb627335b84b0a5ddac5b3cd2425860b27b50ee8c0ed966477cb6f30b2ef93549a831263f59b6123077ea2fc2f6c6287325b0d70a9c5f3dd2761667f72fe018db05159eee9bef53671d9ca06ebebd4259f4fa4eb41aa4fc76ad63d42b1bc939c162a90b5970ae59ae77e89d9e43488768a41169651145ab8a008a6ef86a0aec44332a68eca1a6f916d8d7e73ffcdede062a83a0212e50b0279d8ba70570fe4e69624909d72a18f9a3ca07c894ba5983b3c39ebdcab8a8e651c0b3f3255737c0423714b73e5a19ad1677fd50d189957563881c768cda5d65e5f11f92b885068cf9d7b8703d534905ea5c12d1386acb9051bc0fed96fc661ef0f0d83d45f279e3526287961a81f6fcc1c456a4d27ba411afa219bf2e9ac1f3e2bf64d1822ca27d3b85663137bf9ba4a199d0ea0e2c19a673869d511f3d829206957a2189153d02d8c0965d278fe82e86533c1e2b71a933e40587f07afd5e52c2a596be36c7944a4a4d990435a898f4d688f244d34afca3af277aa7fcda1db42cfb76cf7e3c9ec01a755a856c01d471f12da59cff6fac6e259f0ba3928174b6fb134087ed19addeac39160d06707f7e04a0b80f9af0cd89ec9a89f9fae9e48d6f67af0281ddf2561a4118d70448d974a2b6a132da9458b20312d691fa4dc174b5fef822d2fee18354c5e43884929b7007a8d25043ce7a081c612fa5b583aa8b00854d01873757eccdd11922e7b9f2ecc9b5dd18fd1d1052be7d25d50bcd1ae0dc09bae201687cb6b6c80779b71622cf168680584c1800aa4561fc5b1b3a371356fc8d8e0c8e731668042560ed39dbd718eab619eac45a382fcf20894187d995b7bbf31d6902ada88a5ca9725b066c669795294bdf2ef6131b636bda96104573d39afdc463746ed4b92e210f77494ca38d02f0c3"))